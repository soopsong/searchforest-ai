quantum key distribution ( qkd ) protocol has been proved to provide unconditionally secure key between two remote legitimate users in theory . key distribution signals are transmitted in a quantum channel which is established by the calibration process to meet the requirement of high count rate and low error rate . all qkd security proofs implicitly assume that the quantum channel has been established securely . however , the eavesdropper may attack the calibration process to break the security assumption of qkd and provide precondition to steal information about the final key successfully . inspired by n. jain et al . , phys . rev . lett.107,110501(2011 ) , we reveal the security risk of the calibration process of a passive - basis - choice bb84 qkd system by launching a quantum man - in - the - middle attack which intercepts all calibration signals and resends faked ones . large temporal bit - dependent or basis - dependent detector efficiency mismatch can be induced . then we propose a basis - dependent detector efficiency mismatch ( bem ) based faked states attack on a single photon bb84 qkd to stress the threat of bem . moreover , the security of single photon qkd systems with bem is studied simply and intuitively . two effective countermeasures are suggested to remove the general security risk of the calibration process .