measurement - device - independent quantum key distribution ( mdi - qkd ) has been demonstrated in both laboratories and field - tests using attenuated lasers combined with the decoy - state technique . although researchers have studied various decoy - state mdi - qkd protocols with two or three decoy states , a clear comparison between these protocols is still missing . this invokes the question of how many types of decoy states are needed for practical mdi - qkd . moreover , the system parameters to implement decoy - state mdi - qkd are only partially optimized in all previous works , which casts doubt on the actual performance of former demonstrations . here , we present analytical and numerical decoy - state methods with one , two and three decoy states . we provide a clear comparison among these methods and find that two decoy states already enable a near optimal estimation and more decoy states can not improve the key rate much in either asymptotic or finite - data settings . furthermore , we perform a full optimization of system parameters and show that full optimization can significantly improve the key rate in the finite - data setting . by simulating a real experiment , we find that full optimization can increase the key rate by more than one order of magnitude compared to non - optimization . a local search method to optimize efficiently the system parameters is proposed . this method can be four orders of magnitude faster than a trivial exhaustive search to achieve a similar optimal key rate . we expect that this local search method could be valuable for general fields in physics .