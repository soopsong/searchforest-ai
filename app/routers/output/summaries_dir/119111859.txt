in qubits made from a weakly anharmonic oscillator the leading source of error at short gate times is leakage of population out of the two dimensional hilbert space that forms the qubit . in this paper we develop a general scheme based on an adiabatic expansion to find pulse shapes that correct this type of error . we find a family of solutions that allows tailoring to what is practical to implement for a specific application . our result contains and improves the previously developed drag technique [ f. motzoi , et . al . , phys . rev . lett . 103 , 110501 ( 2009 ) ] and allows a generalization to other non - linear oscillators with more than one leakage transition .