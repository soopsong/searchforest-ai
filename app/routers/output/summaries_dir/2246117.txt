a major obstacle to implementing shor 's quantum number - factoring algorithm is the large size of modular - exponentiation circuits . we reduce this bottleneck by customizing reversible circuits for modular multiplication to individual runs of shor 's algorithm . our circuit - synthesis procedure exploits spectral properties of multiplication operators and constructs optimized circuits from the traces of the execution of an appropriate gcd algorithm . empirically , gate counts are reduced by 4 - 5 times , and circuit latency is reduced by larger factors .