we present reversible classical circuits for performing various arithmetic operations aided by dirty ancillae ( i.e. extra qubits in an unknown state that must be restored before the circuit ends ) . we improve the number of clean qubits needed to factor an n - bit number with shor 's algorithm from 1.5n+o(1 ) to n+2 , assisted by n-1 dirty qubits , without increasing the asymptotic size or depth of the circuit .