quantum key distribution ( qkd ) utilizes the laws of quantum mechanics to achieve information - theoretically secure key generation . this field is now approaching the stage of commercialization , but many practical qkd systems still suffer from security loopholes due to imperfect devices . in fact , practical attacks have successfully been demonstrated . fortunately , most of them only exploit detection - side loopholes which are now closed by the recent idea of measurement - device - independent qkd . on the other hand , little attention is paid to the source which may still leave qkd systems insecure . in this work , we propose and demonstrate an attack that exploits a source - side loophole existing in qubit - based qkd systems using a weak coherent state source and decoy states . specifically , by implementing a linear - optics unambiguous - state - discrimination measurement , we show that the security of a system without phase randomization --- which is a step assumed in conventional security analyses but sometimes neglected in practice --- can be compromised . we conclude that implementing phase randomization is essential to the security of decoy - state qkd systems under current security analyses .