we provide an efficient method for the calculation of high - gain , twin - beam generation in waveguides . equations of motion are derived that naturally accommodate photon generation via spontaneous parametric down - conversion ( spdc ) or spontaneous four - wave mixing ( sfwm ) , and also include the effects of both self - phase modulation ( spm ) of the pump , and of cross - phase modulation ( xpm ) of the twin beams by the pump . the equations we solve involve fields that evolve in space and are labelled by a frequency . we provide a proof that these fields satisfy bonafide commutation relations , and that in the distant past and future they reduce to standard time - evolving heisenberg operators . finally , we consider the example of high - gain spdc in a waveguide with a flat nonlinearity profile , for which our approach provides an explicit solution that requires only a single matrix exponentiation .