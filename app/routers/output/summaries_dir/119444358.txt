we show that the franck - condon factor ( fcf ) associated to a transition between initial and final vibrational states in two different potential energy surfaces , having $ n$ and $ m$ vibrational quanta , respectively , is equivalent to calculating the number of perfect matchings of a weighted graph with loops that has $ p = n+m$ vertices . this last quantity is the loop hafnian of the ( symmetric ) adjacency matrix of the graph which can be calculated in $ o(p^3 2^{p/2})$ steps . in the limit of small numbers of vibrational quanta per normal mode our loop hafnian formula significantly improves the speed at which fcfs can be calculated . our results more generally apply to the calculation of the matrix elements of a bosonic gaussian unitary between two multimode fock states having $ n$ and $ m$ photons in total and provide a useful link between certain calculations of quantum chemistry , quantum optics and graph theory .