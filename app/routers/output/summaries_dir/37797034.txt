we analyzed the security of the secure direct communication protocol based on secret transmitting order of particles recently proposed by zhu , xia , fan , and zhang [ phys . rev . a 73 , 022338 ( 2006 ) ] , and found that this scheme is insecure if an eavesdropper , say eve , wants to steal the secret message with trojan horse attack strategies . the vital loophole in this scheme is that the two authorized users check the security of their quantum channel only once . eve can insert another spy photon , an invisible photon or a delay one in each photon which the sender alice sends to the receiver bob , and capture the spy photon when it returns from bob to alice . after the authorized users check the security , eve can obtain the secret message according to the information about the transmitting order published by bob . finally , we present a possible improvement of this protocol .