we describe an implementation of shor 's quantum algorithm to factor n - bit integers using only 2n+2 qubits . in contrast to previous space - optimized implementations , ours features a purely toffoli based modular multiplication circuit . the circuit depth and the overall gate count are in o(n^3 ) and o(n^3 log(n ) ) , respectively . we thus achieve the same space and time costs as takahashi et al . , while using a purely classical modular multiplication circuit . as a consequence , our approach evades most of the cost overheads originating from rotation synthesis and enables testing and localization of faults in both , the logical level circuit and an actual quantum hardware implementation . our new ( in - place ) constant - adder , which is used to construct the modular multiplication circuit , uses only dirty ancilla qubits and features a circuit size and depth in o(n log(n ) ) and o(n ) , respectively .