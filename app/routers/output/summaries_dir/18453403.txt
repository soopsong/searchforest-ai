we study the computational complexity of the problem sft ( sum - free formula partial trace ) : given a tensor formula f over a subsemiring of the complex field ( c,+ , . ) plus a positive integer k , under the restrictions that all inputs are column vectors of l2-norm 1 and norm - preserving square matrices , and that the output matrix is a column vector , decide whether the k - partial trace of $ f\dagg{f}$ is superior to 1/2 . the k - partial trace of a matrix is the sum of its lowermost k diagonal elements . we also consider the promise version of this problem , where the 1/2 threshold is an isolated cutpoint . we show how to encode a quantum or reversible gate array into a tensor formula which satisfies the above conditions , and vice - versa ; we use this to show that the promise version of sft is complete for the class bpp for formulas over the semiring ( q^+,+ , . ) of the positive rational numbers , for bqp in the case of formulas defined over the field ( q,+ , . ) , and for p in the case of formulas defined over the boolean semiring , all under logspace - uniform reducibility . this suggests that the difference between probabilistic and quantum polynomial - time computers may ultimately lie in the possibility , in the latter case , of having destructive interference between computations occuring in parallel .